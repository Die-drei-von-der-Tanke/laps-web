{
  "Hosting": {
    "Environment": "HttpSys",
    "HttpSys": {
      "HttpPort": 5000,
      "HttpsPort": 5001,
      "Hostname": "localhost",
      "MaxAccepts": 100,
      "EnableResponseCaching": false,
      "ThrowWriteExceptions": false,
      "MaxConnections": 100,
      "RequestQueueLimit": 1000,
      "MaxRequestBodySize": 2480000,
      "AllowSynchronousIO": false,
      "Http503Verbosity": "Limited",
      "ClientCertificateMethod": "NoCertificate"
    }
  },
  "Authentication": {
    "Mode": "Iwa",
    "Iwa": {
      "AuthenticationSchemes": "Negotiate",
      "ClaimName": "http://schemas.microsoft.com/ws/2008/06/identity/claims/primarysid",
      "IdpLogout": false
    },
    "Oidc": {
      "Authority": "bla",
      "ClientID": "bla",
      "ResponseType": "code id_token",
      "Secret": "bla",
      "ClaimName": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn",
      "IdpLogout": true,
      "Scopes": [
        "profile",
        "openid"
      ]
    },
    "WsFed": {
      "Metadata": "bla",
      "Realm": "bla",
      "ClaimName": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn",
      "IdpLogout": true
    }
  },
  "Authorization": {
    "PowershellProvider": {
      "ScriptFile": "scripts\\authzsample.ps1",
      "Enabled": true,
      "ScriptTimeout": 30
    },
    "JsonProvider": {
      "AuthorizationFile": "targets.json",
      "Enabled": true
    },
    "BuiltInProvider": {
      "Targets": [
        {
          "Id": "S-1-5-21-639624971-2667923174-1539603190-3359",
          "Type": "Computer",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "O:BAG:S-1-5-21-639624971-2667923174-1539603190-1122D:(A;;0x800;;;BA)(A;;0x1800;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
          "Jit": {
            "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3370",
            "ExpireAfter": "00:00:15"
          },
          "Laps": {
            "ExpireAfter": "02:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "email-domain-admins"
            ],
            "OnSuccess": [
              "email-domain-admins"
            ]
          }
        },
        {
          "Id": "S-1-5-21-639624971-2667923174-1539603190-3376",
          "Type": "Computer",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "D:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
          "Jit": {
            "AuthorizingGroup": "IDMDEV1\\JIT-{computername}",
            "ExpireAfter": "02:00:00"
          },
          "Laps": {
            "ExpireAfter": "01:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "email-domain-admins"
            ],
            "OnSuccess": [
              "email-domain-admins"
            ]
          }
        },
        {
          "Id": "DC=idmdev1,dc=local",
          "Type": "Container",
          "AuthorizationMode": "SecurityDescriptor",
          "SecurityDescriptor": "O:BAG:S-1-5-21-639624971-2667923174-1539603190-1122D:(A;;0x800;;;BA)(A;;0x1800;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
          "Jit": {
            "AuthorizingGroup": "EXTDEV\\G-GG-1",
            "ExpireAfter": "01:00:00"
          },
          "Laps": {
            "ExpireAfter": "01:00:00",
            "RetrievalLocation": "Auto"
          },
          "Notifications": {
            "OnFailure": [
              "email-domain-admins"
            ],
            "OnSuccess": [
              "email-domain-admins"
            ]
          }
        }
      ]
    }
  },
  "Auditing": {
    "NotificationChannels": {
      "Smtp": [
        {
          "TemplateSuccess": "EmailAuditSuccess.html",
          "TemplateFailure": "EmailAuditFailure.html",
          "EmailAddresses": [
            "laps@lithnet.local"
          ],
          "Enabled": true,
          "Id": "email-domain-admins",
          "Mandatory": false,
          "DisplayName": "Email LAPS adminstrator"
        },
        {
          "TemplateSuccess": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\NotificationTemplates\\EmailAuditSuccess.html",
          "TemplateFailure": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\NotificationTemplates\\EmailAuditFailure.html",
          "EmailAddresses": [
            "support@lithnet.io"
          ],
          "Enabled": true,
          "Id": "5263b7d5-0d0d-4d05-892b-40f2e98a3f72",
          "Mandatory": false,
          "DisplayName": "Email support"
        }
      ],
      "Webhooks": [
        {
          "TemplateSuccess": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\NotificationTemplates\\SlackTemplateSuccess.json",
          "TemplateFailure": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\NotificationTemplates\\SlackTemplateFailure.json",
          "Url": "https://xx",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": false,
          "Id": "slack-web-hook-da-channel",
          "Mandatory": false,
          "DisplayName": "Post to slack"
        },
        {
          "TemplateSuccess": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\NotificationTemplates\\TeamsTemplateSuccess.json",
          "TemplateFailure": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\NotificationTemplates\\TeamsTemplateFailure.json",
          "Url": "https://xx",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": false,
          "Id": "teams-web-hook-da-channel",
          "Mandatory": false,
          "DisplayName": "Post to teams"
        }
      ],
      "Powershell": [
        {
          "Script": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\Scripts\\AuditingSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "send-to-powershell",
          "Mandatory": false,
          "DisplayName": "My script"
        },
        {
          "Script": "D:\\dev\\git\\lithnet\\laps-web\\src\\Lithnet.Laps.Web\\Lithnet.AccessManager.Web\\Scripts\\AuthZSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "a92332b1-f05d-450d-bfef-c4596cbbd825",
          "Mandatory": false,
          "DisplayName": "my really long script name goes here my really long script name goes here my really long script name goes here "
        }
      ]
    },
    "GlobalNotifications": {
      "OnFailure": [
        "email-domain-admins"
      ],
      "OnSuccess": [
        "email-domain-admins"
      ]
    }
  },
  "Email": {
    "Host": "smtp.lithnet.local",
    "Port": 25,
    "UseSsl": true,
    "UseDefaultCredentials": false,
    "Username": "username",
    "Password": "password1232131",
    "FromAddress": "laps@lithnet.local"
  },
  "RateLimits": {
    "PerIP": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    },
    "PerUser": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    }
  },
  "UserInterface": {
    "Title": "Lithnet Admin Access Service",
    "UserSuppliedReason": "Optional",
    "AllowLaps": true,
    "AllowJit": true,
    "AllowLapsHistory": true
  },
  "ForwardedHeaders": {
    "ForwardedForHeaderName": "X-FF",
    "ForwardedHostHeaderName": "X-FH",
    "ForwardedProtoHeaderName": "X-Forwarded-Proto",
    "OriginalForHeaderName": "X-Original-For",
    "OriginalHostHeaderName": "X-Original-Host",
    "OriginalProtoHeaderName": "X-Original-Proto",
    "ForwardedHeaders": "XForwardedFor",
    "ForwardLimit": 0,
    "AllowedHosts": [
      "localhost"
    ],
    "RequireHeaderSymmetry": false,
    "KnownProxies": [
      "127.0.0.1"
    ],
    "KnownNetworks": [
      "127.0.0.1/8"
    ]
  }
}